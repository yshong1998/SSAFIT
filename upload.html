<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SSAFIT - 운동 영상 업로드</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        /* 페이지 전체를 중앙 정렬하는 스타일 */
body {
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 100vh;
    background-color: #f8f9fa; /* 연한 회색 배경 */
}

/* 폼 컨테이너 스타일 */
.upload-container {
    width: 100%;
    max-width: 550px; /* 폼의 최대 너비 설정 */
    padding: 3rem;
    background-color: white;
    border-radius: 20px;
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.08); /* 부드러운 그림자 효과 */
}

/* 폼 제목 스타일 */
.form-title {
    font-weight: 800; /* 굵은 폰트 */
    margin-bottom: 2.5rem;
    color: #333;
}

/* 입력 필드 라벨 스타일 */
.form-label {
    font-weight: 600; /* 약간 굵게 */
    margin-bottom: 0.75rem;
    color: #555;
}

/* 입력 필드(input, textarea) 공통 스타일 */
.form-control {
    padding: 0.8rem 1rem;
    border: 1px solid #ced4da;
    border-radius: 8px;
    transition: border-color 0.2s, box-shadow 0.2s; /* 부드러운 전환 효과 */
}

/* 입력 필드에 포커스될 때의 스타일 */
.form-control:focus {
    border-color: #86b7fe;
    box-shadow: 0 0 0 0.25rem rgba(13, 110, 253, 0.25);
}

/* 버튼 그룹 정렬 */
.button-group {
    display: flex;
    justify-content: flex-end; /* 버튼을 오른쪽으로 정렬 */
    gap: 0.75rem; /* 버튼 사이 간격 */
    margin-top: 2rem;
}

/* 버튼 공통 스타일 */
.btn {
    padding: 0.75rem 1.5rem;
    font-weight: bold;
    border-radius: 8px;
    border: none;
}

/* '취소' 버튼 스타일 (이미지의 회색 버튼) */
#cancelButton {
    background-color: #adb5bd; /* 회색 계열 */
    color: white;
}
#cancelButton:hover {
    background-color: #868e96;
}

/* '업로드' 버튼 스타일 (이미지의 청록색 버튼) */
#submitButton {
    background-color: #48e5c2; /* 밝은 청록색 */
    color: white;
}
#submitButton:hover {
    background-color: #25cba5;
}

    </style>
    
</head>
<body>

    <!-- 전체 폼을 감싸는 컨테이너 -->
    <div class="upload-container">
        <!-- 페이지 제목 -->
        <h2 class="form-title">운동 영상 업로드</h2>

        <!-- 영상 정보 입력 폼 -->
        <form id="uploadForm">
            <!-- YouTube URL 입력 필드 -->
            <div class="mb-4">
                <label for="youtubeUrl" class="form-label">YouTube URL *</label>
                <input type="url" class="form-control" id="youtubeUrl" placeholder="https://www.youtube.com/watch?v=..." required>
            </div>

            <!-- 영상 제목 입력 필드 -->
            <div class="mb-4">
                <label for="videoTitle" class="form-label">영상 제목 *</label>
                <input type="text" class="form-control" id="videoTitle" placeholder="운동 영상의 제목을 입력하세요" required>
            </div>

            <!-- 영상 설명 입력 필드 -->
            <div class="mb-4">
                <label for="videoDescription" class="form-label">영상 설명</label>
                <textarea class="form-control" id="videoDescription" rows="5" placeholder="영상에 대한 자세한 설명을 입력하세요..."></textarea>
            </div>

            <!-- 버튼 그룹 -->
            <div class="button-group">
                <button type="button" class="btn btn-secondary" id="cancelButton">취소</button>
                <button type="submit" class="btn btn-primary" id="submitButton">업로드</button>
            </div>
        </form>
    </div>

    <!-- Bootstrap JS Bundle -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <!-- 여기에 나중에 추가할 custom.js 스크립트 파일을 넣을 수 있습니다. -->
    <!-- <script src="upload-script.js"></script> -->
</body>

<script>
    document.addEventListener('DOMContentLoaded', function() {
    // 1. 필요한 DOM 요소들을 가져옵니다.
    const uploadForm = document.getElementById('uploadForm');
    const cancelButton = document.getElementById('cancelButton');

    // 2. 폼 제출(submit) 이벤트 리스너를 추가합니다.
    uploadForm.addEventListener('submit', function(event) {
        // 폼의 기본 동작(페이지 새로고침)을 막습니다.
        event.preventDefault();

        // 입력된 값들을 가져옵니다.
        const url = document.getElementById('youtubeUrl').value;
        const title = document.getElementById('videoTitle').value.trim();
        const description = document.getElementById('videoDescription').value.trim();

        // YouTube URL에서 비디오 ID를 추출하는 함수 호출
        const videoId = extractYouTubeVideoId(url);

        // 비디오 ID 추출에 실패하면 사용자에게 알리고 함수를 종료합니다.
        if (!videoId) {
            alert('유효하지 않은 YouTube URL입니다. URL을 다시 확인해주세요.');
            return;
        }

        // 새로운 영상 정보를 객체로 만듭니다.
        const newVideo = {
            id: videoId,
            title: title,
            description: description
        };
        
        // --- localStorage에 데이터 저장 로직 ---
        // 기존에 저장된 영상 목록을 불러옵니다. 없으면 빈 배열로 시작합니다.
        let videos = JSON.parse(localStorage.getItem('ssafit_videos')) || [];
        
        // 새로운 영상을 배열의 맨 앞에 추가합니다.
        videos.unshift(newVideo);
        
        // 수정된 배열을 다시 localStorage에 저장합니다.
        localStorage.setItem('ssafit_videos', JSON.stringify(videos));

        // 사용자에게 성공 메시지를 보여주고, 메인 페이지(index.html)로 이동합니다.
        alert('영상 업로드가 완료되었습니다!');
        window.location.href = 'index.html'; // 메인 페이지 파일명으로 변경 가능
    });

    // 3. '취소' 버튼에 클릭 이벤트 리스너를 추가합니다.
    cancelButton.addEventListener('click', function() {
        // 이전 페이지로 돌아갑니다.
        history.back();
    });

    /**
     * 다양한 형태의 YouTube URL에서 비디오 ID를 추출하는 함수입니다.
     * @param {string} url - 검사할 YouTube URL
     * @returns {string|null} - 추출된 비디오 ID 또는 null
     */
    function extractYouTubeVideoId(url) {
        const regex = /(?:youtube\.com\/(?:[^\/]+\/.+\/|(?:v|e(?:mbed)?)\/|.*[?&]v=)|youtu\.be\/)([^"&?\/\s]{11})/;
        const match = url.match(regex);
        return match ? match[1] : null;
    }
});

</script>
</html>
